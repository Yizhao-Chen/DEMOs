setwd("E:\\traceable_scheme")

#lignion_leaf = 0.3334
#lignion_fr = 0.3334
#lignion_wd = 0.3

#ENF
C_1 = c(0.5,0.02,1,0.02,14.8,18.5,1.435,1.766,1.464,6,4.6415152,0.25,0.0045) 
C_ENF_1 = solve(diag(C_1))


B_1 = c(0.3,0.3,0.25,0.15,0,0,0,0,0,0,0,0,0) *1.1
B_ENF = t(t(B_1))

A1 = diag(1,13,13)
A1[5,1] = -0.242 
A1[7,1] = -0.242
A1[6,3] = -0.758
A1[8,3] = -0.758
A1[9,2] = -1
A1[9,4] = -1
A1[10,5] = -0.4
A1[10,7] = -0.2667
A1[11,6] = -0.5
A1[11,8] = -0.3
A1[11,9] = -0.315
A1[11,12] = -0.45
A1[11,13] = -0.625
A1[12,7] = -0.233
A1[12,8] = -0.233
A1[12,9] = -0.165
A1[12,10] = -0.4
A1[12,11] = -0.462928295 *1.1
A1[13,11] = -0.008764256 *1.1
A1[13,12] = -0.001378803 *1.1
A_ENF_1 = solve(A1)

env_ENF = c(1,1,1,1,0.0593758,0.0593758,0.0593758,0.0593758,0.0593758,0.0593758,0.0593758,0.0593758,0.0593758)
env_ENF_m = diag(env_ENF)
env_ENF_1 = solve(env_ENF_m)


#EBF
C_2 = c(1,0.04,1,0.04,14.8,18.5,1.435,1.766,1.464,6,4.205546425,0.25,0.0045)
C_EBF_1 = solve(diag(C_2))

B_2 = c(0.3,0.5,0.1,0.1,0,0,0,0,0,0,0,0,0)*1.1
B_EBF = t(t(B_2))

A2 = diag(1,13,13)
A2[5,1] = -0.242
A2[7,1] = -0.242
A2[6,3] = -0.758
A2[8,3] = -0.758
A2[9,2] = -1
A2[9,4] = -1
A2[10,5] = -0.4
A2[10,7] = -0.2667
A2[11,6] = -0.5
A2[11,8] = -0.3
A2[11,9] = -0.315
A2[11,12] = -0.45
A2[11,13] = -0.625
A2[12,7] = -0.233
A2[12,8] = -0.233
A2[12,9] = -0.165
A2[12,10] = -0.4
A2[12,11] = -0.513889646 *1.1
A2[13,11] = -0.012835392 *1.1
A2[13,12] = -0.000233796 *1.1
A_EBF_1 = solve(A2)

env_EBF = c(1,1,1,1,0.371338,0.371338,0.371338,0.371338,0.371338,0.371338,0.371338,0.371338,0.371338)
env_EBF_m = diag(env_EBF)
env_EBF_1 = solve(env_EBF_m)


#DNF
C_3 = c(1,0.01,1,0.01,14.8,18.5,1.435,1.766,1.464,6,5.20619575,0.25,0.0045)
C_DNF_1 = solve(diag(C_3))

B_3 = c(0.3,0.5,0.1,0.1,0,0,0,0,0,0,0,0,0)*1.1
B_DNF = t(t(B_3))

A3 = diag(1,13,13)
A3[5,1] = -0.242
A3[7,1] = -0.242
A3[6,3] = -0.758
A3[8,3] = -0.758
A3[9,2] = -1
A3[9,4] = -1
A3[10,5] = -0.4
A3[10,7] = -0.2667
A3[11,6] = -0.5
A3[11,8] = -0.3
A3[11,9] = -0.315
A3[11,12] = -0.45
A3[11,13] = -0.625
A3[12,7] = -0.233
A3[12,8] = -0.233
A3[12,9] = -0.165
A3[12,10] = -0.4
A3[12,11] = -0.393082781 *1.1
A3[13,11] = -0.007329952 *1.1
A3[13,12] = -0.001782201 *1.1
A_DNF_1 = solve(A3)

env_DNF = c(1,1,1,1,0.0531499,0.0531499,0.0531499,0.0531499,0.0531499,0.0531499,0.0531499,0.0531499,0.0531499)
env_DNF_m = diag(env_DNF)
env_DNF_1 = solve(env_DNF_m)


#DBF
C_4 = c(1,0.01,1,0.01,14.8,18.5,1.435,1.766,1.464,6,4.357751425,0.25,0.0045)
C_DBF_1 = solve(diag(C_4))

B_4 = c(0.3,0.4,0.2,0.1,0,0,0,0,0,0,0,0,0)*1.1
B_DBF = t(t(B_4))

A4 = diag(1,13,13)
A4[5,1] = -0.242
A4[7,1] = -0.242
A4[6,3] = -0.758
A4[8,3] = -0.758
A4[9,2] = -1
A4[9,4] = -1
A4[10,5] = -0.4
A4[10,7] = -0.2667
A4[11,6] = -0.5
A4[11,8] = -0.3
A4[11,9] = -0.315
A4[11,12] = -0.45
A4[11,13] = -0.625
A4[12,7] = -0.233
A4[12,8] = -0.233
A4[12,9] = -0.165
A4[12,10] = -0.4
A4[12,11] = -0.497097621 *1.1
A4[13,11] = -0.010414528 *1.1
A4[13,12] = -0.000914664 *1.1
A_DBF_1 = solve(A4)

env_DBF = c(1,1,1,1,0.180164,0.180164,0.180164,0.180164,0.180164,0.180164,0.180164,0.180164,0.180164)
env_DBF_m = diag(env_DBF)
env_DBF_1 = solve(env_DBF_m)

#MF
C_5 = c(0.75,0.06,1,0.06,14.8,18.5,1.435,1.766,1.464,6,4.5612079,0.25,0.0045)
C_MF_1 = solve(diag(C_5))

B_5 = c(0.3,0.4,0.2,0.1,0,0,0,0,0,0,0,0,0)*1.1
B_MF = t(t(B_5))

A5 = diag(1,13,13)
A5[5,1] = -0.242
A5[7,1] = -0.242
A5[6,3] = -0.758
A5[8,3] = -0.758
A5[9,2] = -1
A5[9,4] = -1
A5[10,5] = -0.4
A5[10,7] = -0.2667
A5[11,6] = -0.5
A5[11,8] = -0.3
A5[11,9] = -0.315
A5[11,12] = -0.45
A5[11,13] = -0.625
A5[12,7] = -0.233
A5[12,8] = -0.233
A5[12,9] = -0.165
A5[12,10] = -0.4
A5[12,11] = -0.472115337 *1.1
A5[13,11] = -0.009714432 *1.1
A5[13,12] = -0.001111566 *1.1
A_MF_1 = solve(A5)

env_MF = c(1,1,1,1,0.143403,0.143403,0.143403,0.143403,0.143403,0.143403,0.143403,0.143403,0.143403)
env_MF_m = diag(env_MF)
env_MF_1 = solve(env_MF_m)

#Shrub   6: close shrub   7: open shrub
C_6 = c(0.75,0.2,1,0.2,14.8,18.5,1.435,1.766,1.464,6,4.7478397,0.25,0.0045)
C_7 = c(0.75,0.2,1,0.2,14.8,18.5,1.435,1.766,1.464,6,4.526217175,0.25,0.0045)
C_open_1 = solve(diag(C_6))
C_close_1 = solve(diag(C_7))

B_shrub = c(0.5,0.2,0.2,0.1,0,0,0,0,0,0,0,0,0)*1.1
B_open = t(t(B_shrub))
B_close = t(t(B_shrub))

A6 = diag(1,13,13)
A6[5,1] = -0.242
A6[7,1] = -0.242
A6[6,3] = -0.758
A6[8,3] = -0.758
A6[9,2] = -1
A6[9,4] = -1
A6[10,5] = -0.4
A6[10,7] = -0.2667
A6[11,6] = -0.5
A6[11,8] = -0.3
A6[11,9] = -0.315
A6[11,12] = -0.45
A6[11,13] = -0.625
A6[12,7] = -0.233
A6[12,8] = -0.233
A6[12,9] = -0.165
A6[12,10] = -0.4
A6[12,11] = -0.447814405 *1.1
A6[13,11] = -0.010456768 *1.1
A6[13,12] = -0.000902784 *1.1
A_close_1 = solve(A6)

A7 = diag(1,13,13)
A7[5,1] = -0.242
A7[7,1] = -0.242
A7[6,3] = -0.758
A7[8,3] = -0.758
A7[9,2] = -1
A7[9,4] = -1
A7[10,5] = -0.4
A7[10,7] = -0.2667
A7[11,6] = -0.5
A7[11,8] = -0.3
A7[11,9] = -0.315
A7[11,12] = -0.45
A7[11,13] = -0.625
A7[12,7] = -0.233
A7[12,8] = -0.233
A7[12,9] = -0.165
A7[12,10] = -0.4
A7[12,11] = -0.477596772 *1.1
A7[13,11] = -0.008649888 *1.1
A7[13,12] = -0.001410969 *1.1
A_open_1 = solve(A7)

env_open = c(1,1,1,1,0.100738,0.100738,0.100738,0.100738,0.100738,0.100738,0.100738,0.100738,0.100738)
env_open_m = diag(env_open)
env_open_1 = solve(env_open_m)

env_close = c(1,1,1,1,0.244089,0.244089,0.244089,0.244089,0.244089,0.244089,0.244089,0.244089,0.244089)
env_close_m = diag(env_close)
env_close_1 = solve(env_close_m)



#Grass/crop
C_8 = c(1,0.0001,1,0.0001,14.8,18.5,1.435,1.766,1.464,6,4.329160975,0.25,0.0045)
C_9 = c(1,0.0001,1,0.0001,14.8,18.5,1.435,1.766,1.464,6,3.917868025,0.25,0.0045)
C_10 = c(1,0.0001,1,0.0001,14.8,18.5,1.435,1.766,1.464,6,4.224774625,0.25,0.0045)

C_grass_1 = solve(diag(C_8))
C_crop_1 = solve(diag(C_9))
C_cropn_1 = solve(diag(C_10))

B_GC = c(0.5,0,0.5,0,0,0,0,0,0,0,0,0,0)*1.1
B_grass = t(t(B_GC)) 
B_crop = t(t(B_GC))
B_cropn = t(t(B_GC))

A8 = diag(1,13,13)
A8[5,1] = -0.242
A8[7,1] = -0.242
A8[6,3] = -0.758
A8[8,3] = -0.758
A8[9,2] = -1
A8[9,4] = -1
A8[10,5] = -0.4
A8[10,7] = -0.2667
A8[11,6] = -0.5
A8[11,8] = -0.3
A8[11,9] = -0.315
A8[11,12] = -0.45
A8[11,13] = -0.625
A8[12,7] = -0.233
A8[12,8] = -0.233
A8[12,9] = -0.165
A8[12,10] = -0.4
A8[12,11] = -0.501033707 *1.1
A8[13,11] = -0.010087424 *1.1
A8[13,12] = -0.001006662 *1.1
A_grass_1 = solve(A8)

A9 = diag(1,13,13)
A9[5,1] = -0.242
A9[7,1] = -0.242
A9[6,3] = -0.758
A9[8,3] = -0.758
A9[9,2] = -1
A9[9,4] = -1
A9[10,5] = -0.4
A9[10,7] = -0.2667
A9[11,6] = -0.5
A9[11,8] = -0.3
A9[11,9] = -0.315
A9[11,12] = -0.45
A9[11,13] = -0.625
A9[12,7] = -0.233
A9[12,8] = -0.233
A9[12,9] = -0.165
A9[12,10] = -0.4
A9[12,11] = -0.551676348 *1.1
A9[13,11] = -0.011362432 *1.1
A9[13,12] = -0.000648066 *1.1
A_crop_1 = solve(A9)

A10 = diag(1,13,13)
A10[5,1] = -0.242
A10[7,1] = -0.242
A10[6,3] = -0.758
A10[8,3] = -0.758
A10[9,2] = -1
A10[9,4] = -1
A10[10,5] = -0.4
A10[10,7] = -0.2667
A10[11,6] = -0.5
A10[11,8] = -0.3
A10[11,9] = -0.315
A10[11,12] = -0.45
A10[11,13] = -0.625
A10[12,7] = -0.233
A10[12,8] = -0.233
A10[12,9] = -0.165
A10[12,10] = -0.4
A10[12,11] = -0.551676348 *1.1
A10[13,11] = -0.011362432 *1.1
A10[13,12] = -0.000648066 *1.1
A_cropn_1 = solve(A10)

env_grass = c(1,1,1,1,0.14376,0.14376,0.14376,0.14376,0.14376,0.14376,0.14376,0.14376,0.14376)
env_grass_m = diag(env_grass)
env_grass_1 = solve(env_grass_m)

env_crop = c(1,1,1,1,0.175539,0.175539,0.175539,0.175539,0.175539,0.175539,0.175539,0.175539,0.175539)
env_crop_m = diag(env_crop)
env_crop_1 = solve(env_crop_m)

env_cropn = c(1,1,1,1,0.233857,0.233857,0.233857,0.233857,0.233857,0.233857,0.233857,0.233857,0.233857)
env_cropn_m = diag(env_cropn)
env_cropn_1 = solve(env_cropn_m)

#other   #11 wetland      #12 barren   #13 snow
C_11 = c(0.75,0.2,1,0.2,14.8,18.5,1.435,1.766,1.464,6,3.977151325,0.25,0.0045)
C_12 = c(0.75,0.2,1,0.2,14.8,18.5,1.435,1.766,1.464,6,4.4085868,0.25,0.0045)
C_13 = c(0.75,0.2,1,0.2,14.8,18.5,1.435,1.766,1.464,6,3.78845545,0.25,0.0045)
C_wetland_1 = solve(diag(C_11)) 
C_barren_1 = solve(diag(C_12)) 
C_snow_1 = solve(diag(C_13)) 

B_other = c(0.5,0.2,0.2,0.1,0,0,0,0,0,0,0,0,0)*1.1
B_wetland = t(t(B_other))
B_barren = t(t(B_other))
B_snow = t(t(B_other))

A11 = diag(1,13,13)
A11[5,1] = -0.242
A11[7,1] = -0.242
A11[6,3] = -0.758
A11[8,3] = -0.758
A11[9,2] = -1
A11[9,4] = -1
A11[10,5] = -0.4
A11[10,7] = -0.2667
A11[11,6] = -0.5
A11[11,8] = -0.3
A11[11,9] = -0.315
A11[11,12] = -0.45
A11[11,13] = -0.625
A11[12,7] = -0.233
A11[12,8] = -0.233
A11[12,9] = -0.165
A11[12,10] = -0.4
A11[12,11] = -0.544262245 *1.1
A11[13,11] = -0.011293184 *1.1
A11[13,12] = -0.000667542 *1.1
A_wetland_1 = solve(A11)

A12 = diag(1,13,13)
A12[5,1] = -0.242
A12[7,1] = -0.242
A12[6,3] = -0.758
A12[8,3] = -0.758
A12[9,2] = -1
A12[9,4] = -1
A12[10,5] = -0.4
A12[10,7] = -0.2667
A12[11,6] = -0.5
A12[11,8] = -0.3
A12[11,9] = -0.315
A12[11,12] = -0.45
A12[11,13] = -0.625
A12[12,7] = -0.233
A12[12,8] = -0.233
A12[12,9] = -0.165
A12[12,10] = -0.4
A12[12,11] = -0.491060718 *1.1
A12[13,11] = -0.010034464 *1.1
A12[13,12] = -0.001021557 *1.1
A_barren_1 = solve(A12)

A13 = diag(1,13,13)
A13[5,1] = -0.242
A13[7,1] = -0.242
A13[6,3] = -0.758
A13[8,3] = -0.758
A13[9,2] = -1
A13[9,4] = -1
A13[10,5] = -0.4
A13[10,7] = -0.2667
A13[11,6] = -0.5
A13[11,8] = -0.3
A13[11,9] = -0.315
A13[11,12] = -0.45
A13[11,13] = -0.625
A13[12,7] = -0.233
A13[12,8] = -0.233
A13[12,9] = -0.165
A13[12,10] = -0.4
A13[12,11] = -0.568590829 *1.1
A13[13,11] = -0.010783744 *1.1
A13[13,12] = -0.000810822 *1.1
A_snow_1 = solve(A13)

env_wetland = c(1,1,1,1,0.184407,0.184407,0.184407,0.184407,0.184407,0.184407,0.184407,0.184407,0.184407)
env_wetland_m = diag(env_wetland)
env_wetland_1 = solve(env_wetland_m)

env_barren = c(1,1,1,1,0.212787,0.212787,0.212787,0.212787,0.212787,0.212787,0.212787,0.212787,0.212787)
env_barren_m = diag(env_barren)
env_barren_1 = solve(env_barren_m)

env_snow = c(1,1,1,1,0.0338296,0.0338296,0.0338296,0.0338296,0.0338296,0.0338296,0.0338296,0.0338296,0.0338296)
env_snow_m = diag(env_snow)
env_snow_1 = solve(env_snow_m)


#A matrix with fixed soil texture
A = diag(1,13,13)
A[5,1] = -0.242
A[7,1] = -0.242
A[6,3] = -0.758
A[8,3] = -0.758
A[9,2] = -1
A[9,4] = -1
A[10,5] = -0.4
A[10,7] = -0.2667
A[11,6] = -0.5
A[11,8] = -0.3
A[11,9] = -0.315
A[11,12] = -0.45
A[11,13] = -0.625
A[12,7] = -0.233
A[12,8] = -0.233
A[12,9] = -0.165
A[12,10] = -0.4
A[12,11] = -0.47
A[13,11] = -0.011
A[13,12] = -0.00075
A_1 = solve(A)

#baseline residence time
B_RT_ENF = C_ENF_1 %*% A_ENF_1 %*% B_ENF                       #1
B_RT_DNF = C_DNF_1 %*% A_DNF_1 %*% B_DNF                       #2                 
B_RT_DBF = C_DBF_1 %*% A_DBF_1 %*% B_DBF                       #3
B_RT_EBF = C_EBF_1 %*% A_EBF_1 %*% B_EBF                       #4
B_RT_MF = C_MF_1 %*% A_MF_1 %*% B_MF                       #5
B_RT_open = C_open_1 %*% A_open_1 %*% B_open                       #6
B_RT_close = C_close_1 %*% A_close_1 %*% B_close                       #7
B_RT_grass = C_grass_1 %*% A_grass_1 %*% B_grass                       #8
B_RT_crop = C_crop_1 %*% A_crop_1 %*% B_crop                       #9
B_RT_cropn = C_cropn_1 %*% A_cropn_1 %*% B_cropn                       #10
B_RT_wetland = C_wetland_1 %*% A_wetland_1 %*% B_wetland                       #11
B_RT_barren = C_barren_1 %*% A_barren_1 %*% B_barren                       #12
B_RT_snow = C_snow_1 %*% A_snow_1 %*% B_snow                       #13

RT_ENF = env_ENF_1 %*% B_RT_ENF                #1
RT_DNF = env_DNF_1 %*% B_RT_DNF                #2
RT_EBF = env_EBF_1 %*% B_RT_EBF                #3
RT_DBF = env_DBF_1 %*% B_RT_DBF                #4
RT_MF = env_MF_1 %*% B_RT_MF                #5
RT_grass = env_grass_1 %*% B_RT_grass                #6
RT_crop = env_crop_1 %*% B_RT_crop                #7
RT_cropn = env_cropn_1 %*% B_RT_cropn                #8
RT_wetland = env_wetland_1 %*% B_RT_wetland                #9
RT_close = env_close_1 %*% B_RT_close                #10
RT_open = env_open_1 %*% B_RT_open                #11
RT_barren = env_barren_1 %*% B_RT_barren                #12
RT_snow = env_snow_1 %*% B_RT_snow                #13

#baseline residence time with fixed A_1
B_RT_ENF_f = C_ENF_1 %*% A_1 %*% B_ENF                       #1
B_RT_DNF_f = C_DNF_1 %*% A_1 %*% B_DNF                       #2                 
B_RT_DBF_f = C_DBF_1 %*% A_1 %*% B_DBF                       #3
B_RT_EBF_f = C_EBF_1 %*% A_1 %*% B_EBF                       #4
B_RT_MF_f = C_MF_1 %*% A_1 %*% B_MF                       #5
B_RT_open_f = C_open_1 %*% A_1 %*% B_open                       #6
B_RT_close_f = C_close_1 %*% A_1 %*% B_close                       #7
B_RT_grass_f = C_grass_1 %*% A_1 %*% B_grass                       #8
B_RT_crop_f = C_crop_1 %*% A_1 %*% B_crop                       #9
B_RT_cropn_f = C_cropn_1 %*% A_1 %*% B_cropn                       #10
B_RT_wetland_f = C_wetland_1 %*% A_1 %*% B_wetland                       #11
B_RT_barren_f = C_barren_1 %*% A_1 %*% B_barren                       #12
B_RT_snow_f = C_snow_1 %*% A_1 %*% B_snow                       #13






